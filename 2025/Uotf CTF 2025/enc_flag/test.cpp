#include<stdio.h>
#include<stdlib.h>
#include<time.h>
#include<iostream>
#include<cstring>
#include<stdint.h>
using namespace std;
unsigned char res[256]={117, 147, 8, 226, 253, 254, 14, 191, 255, 23, 31, 89, 111, 175, 19, 160, 102, 173, 133, 47, 43, 104, 156, 59, 95, 177, 186, 20, 35, 159, 195, 204, 83, 75, 139, 215, 53, 84, 164, 40, 194, 30, 50, 51, 25, 150, 221, 122, 171, 222, 91, 11, 15, 68, 148, 236, 245, 4, 52, 158, 196, 197, 48, 179, 32, 109, 130, 123, 131, 161, 146, 67, 27, 124, 178, 180, 183, 55, 13, 38, 7, 71, 143, 172, 63, 193, 207, 60, 217, 18, 103, 105, 155, 37, 9, 116, 163, 176, 187, 66, 62, 79, 24, 208, 5, 125, 41, 45, 85, 127, 129, 113, 90, 10, 76, 3, 118, 39, 87, 28, 99, 107, 115, 26, 119, 135, 93, 151, 97, 17, 33, 153, 88, 157, 12, 162, 140, 56, 167, 108, 166, 192, 86, 199, 70, 81, 73, 182, 29, 200, 72, 201, 46, 61, 82, 128, 65, 80, 64, 112, 142, 100, 69, 134, 202, 22, 174, 181, 0, 126, 44, 184, 185, 189, 190, 138, 203, 209, 210, 211, 98, 110, 120, 121, 137, 132, 54, 213, 218, 206, 168, 219, 220, 58, 57, 223, 154, 224, 225, 227, 42, 229, 230, 114, 49, 231, 6, 92, 136, 106, 170, 233, 144, 235, 78, 238, 239, 205, 240, 36, 74, 2, 77, 234, 241, 243, 21, 169, 149, 244, 101, 198, 94, 165, 141, 216, 232, 237, 242, 16, 246, 214, 34, 212, 145, 247, 248, 249, 250, 1, 228, 96, 251, 188, 252, 152};
unsigned char sbox[256];
int v4;
unsigned int v5, v7, v9;
unsigned char v10, v6;
bool brute_time(unsigned int _time){
    memset(sbox, 255, 256);
    v4 = 64;
    v5 = _time;
    srandom(v5);
    do {
        v6 = 0;
        v7 = random();
        do {
            for (int i = (unsigned char)v7; ; i = (unsigned char)(i + 1) ){
                v9 = i;
                if ( sbox[i] == 0xFF )
                    break;
            }
            v10 = -4 * v4 + v6++;
            v7 >>= 8;
            sbox[v9] = v10;
            if (sbox[v9] != res[v9]){
                return false;
            }
        } while (v6 != 4);
        --v4;
    } while (v4);
    return true;
}


int main(){
    unsigned int x=2033295305;

    // for (unsigned int i=2033295305 - 10;i<0xffffffff;i++){
    //     // printf("\r %x",i);
    //     if (brute_time(i)){
    //         cout << "Found: " << i << endl;
    //         break;
    //     }
    // }
    srandom(x);
    for (int i=0;i<64;i++){
        x = random();
    }
    unsigned char key[16];
    uint64_t y = random();
    uint64_t z = random();
    memcpy(key, &y, 8);
    memcpy(key+8, &z, 8);
    cout << "Key: ";
    for (int i=0;i<16;i++){
        cout << "0x" << hex << (int)key[i] << ",";
    }
    return 0;
}
