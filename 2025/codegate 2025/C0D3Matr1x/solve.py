import numpy as np

def convert_matrix(array):
    matrix = [array[i:i + 24] for i in range(0, len(array), 24)]
    return np.array(matrix)
cipher = np.array([59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 19, 61, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 1, 12, 61, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 4, 12, 12, 54, 54, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 80, 12, 12, 12, 12, 61, 6, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 5, 65, 12, 61, 54, 61, 18, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 12, 61, 12, 54, 12, 31, 19, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 79, 59, 59, 59, 24, 12, 54, 12, 61, 54, 28, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 62, 84, 59, 59, 59, 59, 63, 61, 54, 12, 61, 61, 56, 55, 59, 59, 59, 59, 59, 59, 59, 59, 22, 84, 3, 84, 59, 59, 59, 59, 59, 59, 81, 12, 61, 61, 61, 61, 59, 59, 59, 59, 59, 59, 67, 84, 84, 84, 84, 68, 59, 59, 59, 59, 59, 59, 59, 59, 52, 61, 61, 12, 59, 59, 59, 59, 41, 3, 3, 84, 3, 50, 60, 59, 59, 59, 59, 38, 70, 59, 59, 59, 59, 59, 25, 31, 59, 59, 55, 84, 84, 84, 3, 73, 1, 59, 59, 59, 59, 59, 59, 18, 73, 47, 44, 59, 59, 59, 59, 59, 59, 59, 59, 61, 66, 47, 3, 84, 84, 63, 59, 59, 59, 59, 59, 38, 84, 12, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 16, 50, 3, 3, 3, 84, 65, 64, 59, 59, 59, 6, 16, 59, 59, 59, 59, 59, 39, 49, 59, 59, 59, 59, 59, 59, 13, 50, 66, 3, 84, 84, 59, 59, 59, 59, 59, 59, 59, 59, 29, 39, 39, 75, 59, 59, 59, 59, 59, 59, 59, 59, 32, 50, 84, 73, 59, 59, 59, 59, 59, 59, 71, 36, 36, 36, 36, 75, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 76, 68, 59, 59, 59, 59, 83, 36, 36, 36, 36, 39, 74, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 34, 39, 36, 39, 36, 36, 15, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 77, 36, 36, 36, 36, 36, 34, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 79, 33, 29, 36, 36, 36, 36, 9, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 20, 36, 36, 36, 36, 36, 36, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 82, 36, 36, 36, 36, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 78, 36, 36, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 59, 10])
S1 = np.array([84, 18, 2, 2, 76, 65, 51, 81, 63, 12, 6, 24, 64, 67, 52, 71, 95, 34, 98, 33, 94, 26, 39, 77, 51, 86, 72, 44, 16, 4, 73, 2, 28, 40, 77, 28, 63, 43, 23, 25, 39, 66, 82, 70, 60, 0, 57, 65, 41, 9, 98, 39, 21, 23, 26, 29, 25, 72, 86, 18, 0, 4, 55, 74, 63, 0, 75, 25, 63, 55, 57, 36, 14, 89, 21, 184, 17, 61, 9, 33, 70, 37, 99, 63, 4, 23, 89, 95, 62, 97, 81, 30, 82, 54, 1, 27, 37, 12, 19, 58, 140, 97, 68, 46, 34, 34, 62, 98, 57, 86, 62, 30, 44, 59, 50, 13, 50, 79, 76, 67, 96, 50, 45, 21, 85, 174, 6, 90, 34, 17, 83, 85, 47, 27, 29, 19, 11, 38, 56, 33, 89, 10, 51, 82, 98, 15, 24, 83, 43, 44, 138, 1, 52, 73, 77, 3, 37, 9, 63, 24, 93, 60, 44, 36, 68, 17, 1, 24, 40, 56, 58, 77, 31, 69, 15, 16, 52, 12, 26, 46, 94, 1, 49, 89, 6, 51, 57, 7, 5, 74, 11, 53, 98, 65, 27, 21, 96, 49, 25, 39, 156, 77, 39, 79, 79, 33, 7, 56, 99, 50, 42, 88, 15, 47, 95, 21, 59, 17, 79, 94, 45, 5, 15, 14, 41, 66, 38, 60, 19, 79, 18, 43, 65, 17, 9, 6, 65, 56, 14, 7, 68, 43, 1, 62, 26, 83, 67, 44, 3, 12, 50, 0, 79, 15, 91, 96, 88, 71, 75, 16, 6, 10, 49, 71, 25, 16, 53, 10, 78, 6, 23, 7, 86, 76, 59, 88, 24, 24, 46, 75, 80, 8, 66, 29, 46, 89, 89, 52, 94, 22, 66, 4, 18, 71, 32, 33, 2, 32, 52, 5, 120, 68, 21, 64, 96, 42, 89, 39, 23, 98, 91, 96, 23, 75, 70, 8, 39, 85, 89, 66, 11, 96, 30, 88, 81, 150, 61, 25, 50, 48, 85, 86, 86, 80, 65, 28, 76, 6, 0, 76, 5, 42, 24, 53, 18, 81, 3, 25, 82, 52, 70, 8, 13, 86, 58, 54, 73, 43, 71, 70, 71, 21, 72, 83, 74, 24, 36, 67, 9, 40, 24, 38, 12, 54, 5, 112, 97, 77, 17, 39, 35, 57, 19, 88, 67, 29, 11, 52, 15, 25, 54, 37, 88, 67, 85, 88, 58, 64, 83, 51, 82, 10, 54, 89, 59, 9, 49, 89, 79, 86, 77, 22, 84, 89, 31, 27, 65, 96, 10, 81, 76, 71, 17, 78, 70, 122, 12, 61, 25, 14, 44, 41, 78, 23, 25, 63, 7, 11, 46, 40, 82, 4, 94, 94, 91, 7, 29, 12, 4, 0, 18, 34, 78, 73, 37, 52, 71, 6, 55, 45, 41, 2, 94, 52, 48, 22, 22, 73, 59, 1, 76, 16, 65, 67, 30, 34, 52, 92, 33, 2, 95, 24, 34, 11, 38, 5, 2, 74, 59, 60, 11, 28, 75, 50, 91, 21, 55, 34, 32, 92, 192, 92, 40, 75, 54, 16, 83, 92, 28, 81, 0, 79, 81, 91, 26, 33, 82, 34, 62, 12, 15, 30, 52, 13, 24, 30, 75, 48, 92, 41, 20, 90, 84, 46, 39, 14, 95, 51, 31, 28, 54, 64, 61, 64, 16, 91, 68, 10, 37, 66, 48, 4, 4, 16, 51, 91, 9, 46, 26, 59, 45, 88, 89, 8, 91, 34, 32, 0, 58, 67, 47, 47, 11, 84, 24, 138])      # 24x24
S2 = np.array([1734, 45904, 64298, 43078, 43989, 64442, 3360, 45764, 3029, 42227, 16484, 48591, 34065, 10513, 50365, 26038, 28688, 8003, 8433, 29288, 28408, 5412, 63144, 930, 14283, 50191, 38688, 5074, 938, 18033, 49660, 8519, 63983, 47274, 33263, 8058, 57002, 35263, 49409, 10642, 58637, 32981, 42946, 1490, 2527, 44581, 52062, 42409, 38755, 47858, 34552, 39932, 17461, 28851, 43921, 17652, 17557, 57921, 17353, 52226, 42872, 20529, 39316, 56289, 59084, 63749, 32468, 28986, 7815, 42529, 58309, 11727, 38338, 63841, 42979, 64215, 8772, 57881, 32764, 19661, 1458, 13716, 63197, 24631, 11407, 1459, 15797, 21345, 36901, 56213, 46025, 25680, 44654, 63311, 46945, 63952, 169, 61708, 60605, 50840, 3106, 32440, 60069, 43896, 17279, 48976, 40352, 28897, 56296, 39744, 47525, 52212, 58514, 46582, 37279, 19251, 40687, 24218, 65472, 2743, 62399, 33411, 16863, 30579, 33204, 47623, 4054, 36819, 23823, 13233, 62896, 65467, 18357, 59895, 55171, 43494, 38593, 6166, 49930, 41933, 30852, 45548, 3169, 3959, 45386, 35583, 51065, 25197, 55129, 27777, 52317, 48410, 38389, 23905, 40094, 25235, 10513, 38744, 46800, 23508, 15256, 56447, 62076, 38934, 56905, 34165, 54599, 28214, 34357, 16021, 55494, 9415, 27480, 40175, 60044, 22572, 51680, 48445, 48206, 53260, 15457, 51703, 57875, 18579, 20934, 42799, 57844, 63335, 6776, 36175, 16955, 55861, 60691, 8843, 52521, 40756, 39293, 23838, 49546, 24921, 27014, 15416, 41078, 64552, 28612, 34641, 38624, 64253, 21190, 18694, 4467, 1116, 56688, 17907, 20548, 37550, 17034, 10712, 50770, 26525, 8511, 48899, 61633, 3690, 48600, 17809, 46521, 9560, 43309, 51334, 49199, 35279, 21397, 50552, 8312, 19167, 50943, 28353, 18965, 4873, 65005, 18060, 36843, 44778, 55411, 7047, 59227, 32949, 9069, 28823, 26711, 27459, 700, 37354, 45085, 30586, 46738, 14616, 53711, 38302, 1394, 22983, 54522, 55723, 36943, 23847, 14700, 19330, 34290, 41712, 51338, 35045, 62690, 27016, 25750, 16437, 15630, 5596, 46813, 52196, 11666, 16783, 39636, 44764, 64070, 9703, 8872, 44773, 6040, 57277, 52627, 1422, 10204, 60159, 43866, 14251, 46991, 24066, 36467, 15084, 63500, 28954, 37196, 56674, 58067, 28158, 13719, 9669, 44312, 58463, 14344, 60246, 13290, 27929, 64460, 41864, 45309, 49777, 60816, 16533, 17423, 9773, 46354, 25146, 25616, 25253, 27029, 40960, 47865, 58437, 9317, 42590, 46595, 49673, 45401, 27698, 285, 15406, 45629, 46201, 40271, 61231, 33598, 65039, 11955, 35707, 25051, 7622, 25908, 14321, 37007, 3453, 53850, 50832, 2857, 12832, 2431, 12826, 51908, 1963, 29614, 56142, 19045, 38560, 25840, 24389, 7799, 11747, 56588, 42184, 13279, 64207, 10673, 1995, 9387, 10777, 17394, 12947, 51538, 33774, 3585, 16972, 11468, 8651, 28703, 18983, 20016, 19164, 2118, 55909, 57841, 54991, 5569, 60792, 53234, 7273, 61189, 56659, 11193, 5121, 3837, 28721, 61401, 22416, 5304, 42438, 64115, 8076, 24945, 42091, 50468, 35448, 11715, 25020, 1186, 56772, 29636, 35920, 53180, 13192, 29680, 59724, 34254, 8380, 36616, 26599, 58824, 27069, 18111, 27108, 61476, 62907, 43921, 3122, 22504, 52272, 50826, 42483, 61375, 24436, 3711, 14719, 61483, 11857, 4094, 13006, 63082, 42653, 37809, 58687, 63572, 24760, 42914, 61271, 27270, 50122, 37860, 45809, 1424, 36037, 61111, 26173, 25361, 56086, 37524, 33433, 189, 64673, 54591, 32352, 65348, 42028, 43249, 20853, 59808, 60180, 56164, 45170, 12665, 22994, 47103, 12000, 64768, 17149, 6139, 43121, 54222, 29625, 21292, 9289, 17832, 58522, 50123, 17559, 22593, 4567, 32008, 18115, 53086, 28764, 49188, 53372, 32534, 40343, 16017, 9375, 59815, 5349, 35893, 31341, 62441, 47350, 56541, 17565, 42276, 3896, 17680, 22685, 30881, 19130, 41957, 2515, 62283, 22277, 55885, 13104, 6473, 10569, 52844, 21145, 832, 51093, 39106, 54801, 25106, 45123, 12883, 64753, 22844, 13462, 2261, 62871, 29750, 57670, 52890, 65011, 46460, 22954, 36660, 27214, 8953, 56085, 714, 7648, 7771, 14863, 43847, 29312, 5821, 33387, 65519, 27044, 3682, 26446, 52675, 9089, 4487, 4812, 54888, 19919, 35244, 30134, 38349, 6421, 54558, 30898])      # 24x24
S3 = np.array([-115, 0, 15, 1, -21, 49, -24, 5, 42, -2, -16, -9, 40, 46, 56, -34, 16, -25, 39, 26, 23, 42, -56, 0, -31, -15, 7, -14, 11, 22, 13, -33, -9, 40, 31, 54, -19, -26, -20, 12, 30, 14, 44, -14, 49, -4, -4, 25, 53, 8, -45, 20, -5, 58, 16, -15, 18, 59, 45, 23, 50, 51, -33, 11, 46, -34, -15, -9, -46, -50, 3, -35, 9, 39, -13, -127, 19, -40, 30, 21, -40, 32, 37, -20, 30, 30, 29, 25, 3, 18, -12, -58, -44, -76, 39, -55, -18, -34, 4, -16, -19, -9, -4, -35, 31, -32, 0, 59, 5, 23, 29, -40, -30, -1, 54, -13, -1, -31, 36, 56, 17, 16, -40, 18, 9, -129, 36, -33, 0, -23, 23, 43, 3, 30, 10, -4, -40, 3, -42, -40, 10, -22, 28, -36, 24, -6, -20, -2, -25, 17, -53, -6, -18, 49, -16, 14, -1, 27, -12, -72, -10, -38, -4, 0, 53, 26, 23, -28, 56, 26, 2, 57, -38, -18, 14, -123, 48, 38, -29, -12, -12, 18, -38, 31, 59, -27, -44, -56, 27, -33, -29, 19, 54, 22, -14, -29, 16, -31, 46, 30, -34, 72, -94, 24, 41, 52, -9, -13, -33, -9, 56, -5, 25, 54, 3, 43, -13, 49, 56, 36, 43, -27, 53, -15, 7, -94, 83, -28, -28, 31, 23, -29, 44, -40, -31, 3, 0, 58, 60, -42, -40, -27, 55, 46, -36, -22, -45, 25, -9, 22, 24, -2, 12, -30, 35, 32, 11, -2, 29, -32, -33, 42, -53, 22, -34, -30, 33, -2, 2, 23, -28, 58, -95, -7, 20, 23, -16, 57, -12, -75, -3, 19, -26, 58, 49, -19, 45, 33, 57, 21, 47, 16, 18, 15, -22, 6, 59, -12, -25, 45, 39, 1, 27, -2, 41, -73, 25, 6, 8, -24, 9, 11, -29, 40, -26, 26, -77, -45, -88, -30, -95, 34, -28, 1, -40, -113, 2, 6, -6, -4, -34, 27, -37, -12, -11, 35, 27, 2, 9, 13, -31, -6, 12, -14, -16, -10, 34, -9, 25, -19, -115, -9, -22, -1, 9, 41, -46, -53, -60, 28, -36, -22, 18, 34, 25, 48, 50, 27, -51, -24, 45, 71, -38, -15, 32, 51, -24, 15, 45, 5, -55, 23, 8, 38, 43, 19, 22, -39, -37, -14, -4, -34, 8, -19, -13, 43, -36, -39, 28, 24, 63, -54, 8, -23, -27, -50, 34, 36, 38, -5, 40, -3, -8, -6, 35, -17, 26, 35, 30, -19, -37, 8, 0, -29, -57, -61, -54, 0, -16, 59, -13, -39, -14, -26, 55, 0, 58, 24, 39, 21, 44, -22, 22, -38, -17, 3, 57, -20, -10, 2, 14, -10, 21, -40, 8, 21, -30, -18, -35, -21, -3, -3, -8, 45, -28, 8, 20, -38, -29, -40, -40, 69, 20, -19, 28, 22, 15, 13, -34, -26, -29, -19, -32, -14, 38, -37, 27, 54, -30, -38, 56, 39, -15, 43, -35, -3, 31, -53, -9, -47, -58, 3, 12, 25, 45, 52, -38, -10, 14, -17, -29, 12, 41, 23, -39, 16, -30, 5, 3, 27, 5, 21, 16, 41, 33, -128, 17, 23, 34, 51, 23, 22, 20, -2, 39, 55, 14, 40, 48, 56, 57, 4, 37, -23, 27, 2, 5, 35, 27, -16, -66, -39, 15, 40, -24, -29, -2, -5, 54, -25, 20, 59, -8, 8, -11, -4, 15, 58, 42, -38, -11, 31, 50, 6, 37, -56])      # 24x24
key = np.array([0x43, 0x30, 0x44, 0x33, 0x47, 0x41, 0x54, 0x33])     
cipher = convert_matrix(cipher)
S1 = convert_matrix(S1)
S2 = convert_matrix(S2)
S3 = convert_matrix(S3)


v23 = np.mod(cipher.reshape(24, 24) - S3 + 65535, 65535)
v23 = v23.flatten()
v23 = [int(i) for i in v23]


import numpy as np
cipher = np.array( [314, 422, 352, 367, 471, 475, 471, 506, 414, 444, 369, 455, 450, 448, 385, 516, 515, 471, 523, 467, 469, 432, 385, 384, 466, 839, 680, 891, 782, 820, 782, 752, 787, 783, 748, 813, 794, 815, 669, 791, 727, 849, 769, 880, 723, 790, 657, 517, 436, 671, 812, 701, 830, 841, 767, 923, 784, 874, 932, 769, 774, 672, 850, 943, 781, 891, 877, 826, 842, 783, 718, 524, 506, 825, 776, 1109, 713, 970, 887, 790, 968, 834, 1003, 919, 969, 879, 973, 866, 949, 850, 817, 924, 721, 910, 746, 486, 379, 588, 690, 726, 973, 970, 841, 1024, 955, 952, 968, 1084, 934, 992, 974, 925, 878, 1024, 885, 794, 875, 695, 674, 437, 585, 676, 917, 867, 937, 1078, 914, 850, 838, 806, 909, 747, 868, 861, 853, 780, 828, 835, 901, 916, 904, 768, 757, 445, 515, 676, 697, 856, 678, 1009, 797, 834, 798, 912, 957, 833, 892, 774, 882, 774, 789, 868, 741, 865, 772, 641, 690, 421, 513, 615, 957, 726, 828, 911, 961, 851, 945, 781, 802, 803, 791, 764, 876, 804, 896, 948, 926, 846, 848, 746, 829, 491, 570, 813, 820, 781, 926, 993, 770, 918, 966, 912, 988, 856, 956, 789, 924, 935, 836, 883, 951, 888, 847, 772, 889, 531, 501, 828, 962, 983, 874, 881, 843, 803, 904, 649, 866, 932, 867, 785, 874, 702, 873, 916, 769, 954, 885, 964, 776, 563, 572, 862, 766, 808, 714, 1077, 922, 900, 845, 815, 896, 847, 869, 784, 847, 890, 952, 980, 974, 776, 760, 742, 866, 569, 461, 801, 804, 824, 944, 832, 796, 606, 809, 732, 817, 873, 815, 866, 773, 741, 750, 773, 920, 905, 882, 916, 759, 577, 612, 763, 838, 748, 795, 990, 895, 761, 752, 789, 801, 900, 891, 955, 687, 777, 871, 901, 1002, 858, 783, 836, 854, 579, 481, 858, 876, 882, 966, 906, 925, 799, 794, 716, 852, 865, 917, 895, 917, 734, 769, 900, 936, 1034, 906, 992, 764, 562, 579, 717, 801, 821, 826, 981, 874, 1027, 936, 849, 862, 797, 869, 729, 921, 903, 876, 1007, 968, 837, 880, 767, 890, 544, 580, 723, 969, 861, 804, 934, 915, 974, 894, 707, 868, 872, 779, 729, 888, 811, 979, 1069, 814, 957, 793, 890, 866, 608, 513, 701, 710, 903, 740, 952, 665, 843, 752, 871, 912, 828, 866, 805, 852, 849, 656, 761, 795, 966, 776, 747, 773, 515, 579, 601, 930, 743, 923, 935, 922, 869, 866, 858, 779, 652, 755, 793, 843, 849, 875, 1006, 920, 905, 898, 691, 829, 371, 450, 528, 640, 832, 707, 959, 804, 940, 951, 837, 888, 918, 846, 779, 809, 833, 823, 888, 724, 916, 772, 643, 619, 351, 579, 623, 832, 969, 759, 910, 991, 756, 933, 732, 918, 820, 950, 835, 971, 715, 952, 818, 803, 919, 710, 861, 740, 349, 478, 611, 751, 741, 956, 890, 859, 1025, 975, 943, 913, 855, 895, 880, 1005, 964, 890, 996, 959, 959, 1039, 813, 694, 474, 523, 683, 741, 1020, 795, 972, 804, 818, 966, 869, 836, 950, 960, 939, 865, 774, 826, 838, 811, 908, 701, 820, 781, 434, 500, 625, 697, 700, 804, 778, 782, 742, 778, 716, 712, 637, 696, 630, 720, 809, 754, 839, 814, 762, 743, 707, 688, 459, 252, 461, 401, 603, 516, 532, 492, 494, 559, 551, 508, 523, 504, 543, 445, 436, 501, 533, 494, 521, 410, 532, 352, 398]).reshape(24, 24)
s1 = np.array([84, 18, 2, 2, 76, 65, 51, 81, 63, 12, 6, 24, 64, 67, 52, 71, 95, 34, 98, 33, 94, 26, 39, 77, 51, 86, 72, 44, 16, 4, 73, 2, 28, 40, 77, 28, 63, 43, 23, 25, 39, 66, 82, 70, 60, 0, 57, 65, 41, 9, 98, 39, 21, 23, 26, 29, 25, 72, 86, 18, 0, 4, 55, 74, 63, 0, 75, 25, 63, 55, 57, 36, 14, 89, 21, 184, 17, 61, 9, 33, 70, 37, 99, 63, 4, 23, 89, 95, 62, 97, 81, 30, 82, 54, 1, 27, 37, 12, 19, 58, 140, 97, 68, 46, 34, 34, 62, 98, 57, 86, 62, 30, 44, 59, 50, 13, 50, 79, 76, 67, 96, 50, 45, 21, 85, 174, 6, 90, 34, 17, 83, 85, 47, 27, 29, 19, 11, 38, 56, 33, 89, 10, 51, 82, 98, 15, 24, 83, 43, 44, 138, 1, 52, 73, 77, 3, 37, 9, 63, 24, 93, 60, 44, 36, 68, 17, 1, 24, 40, 56, 58, 77, 31, 69, 15, 16, 52, 12, 26, 46, 94, 1, 49, 89, 6, 51, 57, 7, 5, 74, 11, 53, 98, 65, 27, 21, 96, 49, 25, 39, 156, 77, 39, 79, 79, 33, 7, 56, 99, 50, 42, 88, 15, 47, 95, 21, 59, 17, 79, 94, 45, 5, 15, 14, 41, 66, 38, 60, 19, 79, 18, 43, 65, 17, 9, 6, 65, 56, 14, 7, 68, 43, 1, 62, 26, 83, 67, 44, 3, 12, 50, 0, 79, 15, 91, 96, 88, 71, 75, 16, 6, 10, 49, 71, 25, 16, 53, 10, 78, 6, 23, 7, 86, 76, 59, 88, 24, 24, 46, 75, 80, 8, 66, 29, 46, 89, 89, 52, 94, 22, 66, 4, 18, 71, 32, 33, 2, 32, 52, 5, 120, 68, 21, 64, 96, 42, 89, 39, 23, 98, 91, 96, 23, 75, 70, 8, 39, 85, 89, 66, 11, 96, 30, 88, 81, 150, 61, 25, 50, 48, 85, 86, 86, 80, 65, 28, 76, 6, 0, 76, 5, 42, 24, 53, 18, 81, 3, 25, 82, 52, 70, 8, 13, 86, 58, 54, 73, 43, 71, 70, 71, 21, 72, 83, 74, 24, 36, 67, 9, 40, 24, 38, 12, 54, 5, 112, 97, 77, 17, 39, 35, 57, 19, 88, 67, 29, 11, 52, 15, 25, 54, 37, 88, 67, 85, 88, 58, 64, 83, 51, 82, 10, 54, 89, 59, 9, 49, 89, 79, 86, 77, 22, 84, 89, 31, 27, 65, 96, 10, 81, 76, 71, 17, 78, 70, 122, 12, 61, 25, 14, 44, 41, 78, 23, 25, 63, 7, 11, 46, 40, 82, 4, 94, 94, 91, 7, 29, 12, 4, 0, 18, 34, 78, 73, 37, 52, 71, 6, 55, 45, 41, 2, 94, 52, 48, 22, 22, 73, 59, 1, 76, 16, 65, 67, 30, 34, 52, 92, 33, 2, 95, 24, 34, 11, 38, 5, 2, 74, 59, 60, 11, 28, 75, 50, 91, 21, 55, 34, 32, 92, 192, 92, 40, 75, 54, 16, 83, 92, 28, 81, 0, 79, 81, 91, 26, 33, 82, 34, 62, 12, 15, 30, 52, 13, 24, 30, 75, 48, 92, 41, 20, 90, 84, 46, 39, 14, 95, 51, 31, 28, 54, 64, 61, 64, 16, 91, 68, 10, 37, 66, 48, 4, 4, 16, 51, 91, 9, 46, 26, 59, 45, 88, 89, 8, 91, 34, 32, 0, 58, 67, 47, 47, 11, 84, 24, 138]).reshape(24, 24)
v23 = np.mod(cipher - s1 + 65535, 65535)
v23 = v23.flatten()
v23 = [int(i) for i in v23]

def f4(a1):
    for i in range(12):
        for j in range(i, 23 - i):
            v3 = a1[24 * j + i]
            a1[24 * j + i] = a1[24 * i + 23 - j]
            a1[24 * i + 23 - j] = a1[24 * (23 - j) + 23 - i]
            a1[24 * (23 - j) + 23 - i] = a1[24 * (23 - i) + j]
            a1[24 * (23 - i) + j] = v3
    return a1
def f2(a1):
    for i in range(12):
        for j in range(i,23-i):
            v3 = a1[24 * j + i]
            a1[24 * j + i] = a1[24 * (23 - i) + j]
            a1[24 * (23 - i) + j] = a1[24 * (23 - j) + 23 - i]
            a1[24 * (23 - j) + 23 - i] = a1[24 * i + 23 - j]
            a1[24 * i + 23 - j] = v3
    return a1
x = v23.copy() 
x = f2(x)
v20 = x.copy()


v19 = [1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]
a1 = np.array(v19).reshape(24,24)
a3 = np.array(v20).reshape(24,24)
v21 = []
if np.linalg.det(a1) != 0:  
    B = np.linalg.inv(a1).dot(a3)
    B = np.round(B).astype(int)
    B = B.tolist()
    
    for i in range(len(B)):
        for j in range(len(B[i])):
            v21.append(B[i][j])
print(v21)
v21 = [248, 408, 469, 383, 508, 372, 500, 446, 509, 503, 458, 518, 436, 504, 442, 472, 473, 417, 489, 342, 492, 395, 415, 230, 328, 640, 706, 654, 707, 582, 785, 724, 847, 819, 699, 763, 670, 817, 762, 794, 818, 689, 706, 598, 745, 661, 600, 346, 350, 677, 658, 717, 777, 615, 853, 699, 897, 801, 806, 772, 751, 765, 883, 793, 899, 673, 872, 671, 755, 714, 608, 350, 399, 706, 677, 847, 658, 694, 873, 717, 758, 807, 820, 760, 836, 754, 820, 832, 843, 704, 815, 825, 639, 779, 663, 375, 507, 720, 767, 918, 718, 700, 839, 725, 730, 821, 927, 777, 866, 688, 829, 830, 797, 635, 852, 833, 696, 809, 766, 395, 447, 746, 759, 927, 773, 706, 908, 741, 797, 910, 851, 913, 854, 899, 760, 909, 869, 697, 845, 835, 736, 802, 687, 425, 466, 743, 804, 857, 897, 758, 891, 611, 879, 850, 836, 863, 773, 855, 828, 745, 946, 659, 908, 773, 878, 741, 709, 420, 443, 738, 811, 835, 887, 819, 805, 574, 882, 863, 719, 775, 670, 864, 808, 737, 890, 696, 817, 834, 887, 718, 688, 420, 514, 683, 885, 916, 885, 869, 801, 664, 885, 918, 783, 750, 723, 842, 863, 810, 893, 746, 804, 921, 898, 759, 759, 351, 413, 659, 803, 914, 895, 780, 826, 769, 883, 851, 856, 666, 727, 756, 856, 917, 827, 819, 824, 912, 884, 795, 646, 333, 419, 681, 810, 902, 896, 794, 769, 827, 844, 859, 822, 749, 758, 846, 828, 949, 776, 880, 826, 906, 904, 846, 671, 363, 413, 642, 878, 820, 891, 755, 679, 808, 767, 787, 836, 771, 791, 790, 848, 877, 697, 855, 821, 877, 965, 774, 731, 386, 515, 609, 917, 827, 747, 824, 571, 740, 834, 772, 777, 895, 785, 847, 872, 777, 757, 830, 662, 986, 856, 751, 785, 431, 509, 566, 905, 830, 834, 772, 722, 741, 675, 677, 745, 887, 842, 769, 706, 756, 763, 765, 834, 906, 856, 668, 772, 381, 463, 665, 778, 883, 710, 833, 762, 804, 667, 768, 620, 757, 656, 803, 583, 835, 769, 839, 789, 918, 797, 802, 743, 432, 436, 745, 762, 943, 699, 821, 771, 798, 699, 895, 709, 713, 666, 794, 659, 879, 715, 750, 761, 895, 771, 869, 766, 445, 435, 728, 739, 951, 704, 900, 842, 806, 907, 974, 733, 728, 599, 856, 789, 879, 835, 833, 760, 978, 757, 894, 750, 425, 466, 748, 808, 962, 751, 888, 884, 751, 992, 921, 852, 859, 765, 909, 899, 833, 897, 808, 797, 965, 753, 891, 783, 437, 486, 732, 891, 885, 908, 948, 846, 927, 910, 939, 821, 919, 826, 994, 876, 944, 842, 965, 904, 873, 909, 818, 816, 410, 474, 752, 895, 867, 885, 882, 844, 877, 918, 783, 948, 819, 876, 760, 948, 800, 839, 829, 883, 781, 894, 801, 810, 434, 512, 610, 928, 730, 924, 769, 721, 851, 778, 745, 874, 744, 814, 746, 889, 760, 649, 773, 846, 668, 925, 662, 847, 365, 448, 641, 790, 721, 769, 570, 677, 738, 833, 724, 912, 738, 827, 732, 908, 725, 672, 624, 758, 616, 856, 728, 790, 406, 445, 584, 667, 587, 617, 505, 515, 672, 702, 711, 783, 741, 785, 819, 811, 748, 559, 661, 626, 576, 736, 662, 753, 404, 260, 455, 386, 399, 347, 299, 330, 426, 520, 474, 534, 483, 525, 498, 556, 510, 438, 397, 363, 370, 459, 488, 452, 307]


v20 = [248, 415, 469, 492, 508, 489, 500, 473, 509, 442, 458, 436, 518, 504, 503, 472, 446, 417, 372, 342, 383, 395, 408, 230, 328, 600, 706, 745, 707, 706, 785, 818, 847, 762, 699, 670, 763, 817, 819, 794, 724, 689, 582, 598, 654, 661, 640, 346, 350, 608, 658, 755, 777, 872, 853, 899, 897, 883, 806, 751, 772, 765, 801, 793, 699, 673, 615, 671, 717, 714, 677, 350, 399, 663, 677, 639, 658, 815, 873, 843, 758, 820, 820, 836, 760, 754, 807, 832, 717, 704, 694, 825, 847, 779, 706, 375, 507, 766, 767, 696, 718, 852, 839, 797, 730, 829, 927, 866, 777, 688, 821, 830, 725, 635, 700, 833, 918, 809, 720, 395, 447, 687, 759, 736, 773, 845, 908, 869, 797, 760, 851, 854, 913, 899, 910, 909, 741, 697, 706, 835, 927, 802, 746, 425, 466, 709, 804, 878, 897, 908, 891, 946, 879, 828, 836, 773, 863, 855, 850, 745, 611, 659, 758, 773, 857, 741, 743, 420, 443, 688, 811, 887, 887, 817, 805, 890, 882, 808, 719, 670, 775, 864, 863, 737, 574, 696, 819, 834, 835, 718, 738, 420, 514, 759, 885, 898, 885, 804, 801, 893, 885, 863, 783, 723, 750, 842, 918, 810, 664, 746, 869, 921, 916, 759, 683, 351, 413, 646, 803, 884, 895, 824, 826, 827, 883, 856, 856, 727, 666, 756, 851, 917, 769, 819, 780, 912, 914, 795, 659, 333, 419, 671, 810, 904, 896, 826, 769, 776, 844, 828, 822, 758, 749, 846, 859, 949, 827, 880, 794, 906, 902, 846, 681, 363, 413, 731, 878, 965, 891, 821, 679, 697, 767, 848, 836, 791, 771, 790, 787, 877, 808, 855, 755, 877, 820, 774, 642, 386, 515, 785, 917, 856, 747, 662, 571, 757, 834, 872, 777, 785, 895, 847, 772, 777, 740, 830, 824, 986, 827, 751, 609, 431, 509, 772, 905, 856, 834, 834, 722, 763, 675, 706, 745, 842, 887, 769, 677, 756, 741, 765, 772, 906, 830, 668, 566, 381, 463, 743, 778, 797, 710, 789, 762, 769, 667, 583, 620, 656, 757, 803, 768, 835, 804, 839, 833, 918, 883, 802, 665, 432, 436, 766, 762, 771, 699, 761, 771, 715, 699, 659, 709, 666, 713, 794, 895, 879, 798, 750, 821, 895, 943, 869, 745, 445, 435, 750, 739, 757, 704, 760, 842, 835, 907, 789, 733, 599, 728, 856, 974, 879, 806, 833, 900, 978, 951, 894, 728, 425, 466, 783, 808, 753, 751, 797, 884, 897, 992, 899, 852, 765, 859, 909, 921, 833, 751, 808, 888, 965, 962, 891, 748, 437, 486, 816, 891, 909, 908, 904, 846, 842, 910, 876, 821, 826, 919, 994, 939, 944, 927, 965, 948, 873, 885, 818, 732, 410, 474, 810, 895, 894, 885, 883, 844, 839, 918, 948, 948, 876, 819, 760, 783, 800, 877, 829, 882, 781, 867, 801, 752, 434, 512, 847, 928, 925, 924, 846, 721, 649, 778, 889, 874, 814, 744, 746, 745, 760, 851, 773, 769, 668, 730, 662, 610, 365, 448, 790, 790, 856, 769, 758, 677, 672, 833, 908, 912, 827, 738, 732, 724, 725, 738, 624, 570, 616, 721, 728, 641, 406, 445, 753, 667, 736, 617, 626, 515, 559, 702, 811, 783, 785, 741, 819, 711, 748, 672, 661, 505, 576, 587, 662, 584, 404, 260, 452, 386, 459, 347, 363, 330, 438, 520, 556, 534, 525, 483, 498, 474, 510, 426, 397, 299, 370, 399, 488, 455, 307]
x = v20.copy() 
x = f4(x)
v20 = x.copy()
# print(v20)
v20 = [230, 346, 350, 375, 395, 425, 420, 420, 351, 333, 363, 386, 431, 381, 432, 445, 425, 437, 410, 434, 365, 406, 404, 307, 408, 640, 677, 706, 720, 746, 743, 738, 683, 659, 681, 642, 609, 566, 665, 745, 728, 748, 732, 752, 610, 641, 584, 455, 395, 661, 714, 779, 809, 802, 741, 718, 759, 795, 846, 774, 751, 668, 802, 869, 894, 891, 818, 801, 662, 728, 662, 488, 383, 654, 717, 847, 918, 927, 857, 835, 916, 914, 902, 820, 827, 830, 883, 943, 951, 962, 885, 867, 730, 721, 587, 399, 342, 598, 671, 825, 833, 835, 773, 834, 921, 912, 906, 877, 986, 906, 918, 895, 978, 965, 873, 781, 668, 616, 576, 370, 372, 582, 615, 694, 700, 706, 758, 819, 869, 780, 794, 755, 824, 772, 833, 821, 900, 888, 948, 882, 769, 570, 505, 299, 417, 689, 673, 704, 635, 697, 659, 696, 746, 819, 880, 855, 830, 765, 839, 750, 833, 808, 965, 829, 773, 624, 661, 397, 446, 724, 699, 717, 725, 741, 611, 574, 664, 769, 827, 808, 740, 741, 804, 798, 806, 751, 927, 877, 851, 738, 672, 426, 472, 794, 793, 832, 830, 909, 745, 737, 810, 917, 949, 877, 777, 756, 835, 879, 879, 833, 944, 800, 760, 725, 748, 510, 503, 819, 801, 807, 821, 910, 850, 863, 918, 851, 859, 787, 772, 677, 768, 895, 974, 921, 939, 783, 745, 724, 711, 474, 504, 817, 765, 754, 688, 899, 855, 864, 842, 756, 846, 790, 847, 769, 803, 794, 856, 909, 994, 760, 746, 732, 819, 498, 518, 763, 772, 760, 777, 913, 863, 775, 750, 666, 749, 771, 895, 887, 757, 713, 728, 859, 919, 819, 744, 738, 741, 483, 436, 670, 751, 836, 866, 854, 773, 670, 723, 727, 758, 791, 785, 842, 656, 666, 599, 765, 826, 876, 814, 827, 785, 525, 458, 699, 806, 820, 927, 851, 836, 719, 783, 856, 822, 836, 777, 745, 620, 709, 733, 852, 821, 948, 874, 912, 783, 534, 442, 762, 883, 820, 829, 760, 828, 808, 863, 856, 828, 848, 872, 706, 583, 659, 789, 899, 876, 948, 889, 908, 811, 556, 509, 847, 897, 758, 730, 797, 879, 882, 885, 883, 844, 767, 834, 675, 667, 699, 907, 992, 910, 918, 778, 833, 702, 520, 473, 818, 899, 843, 797, 869, 946, 890, 893, 827, 776, 697, 757, 763, 769, 715, 835, 897, 842, 839, 649, 672, 559, 438, 500, 785, 853, 873, 839, 908, 891, 805, 801, 826, 769, 679, 571, 722, 762, 771, 842, 884, 846, 844, 721, 677, 515, 330, 489, 706, 872, 815, 852, 845, 908, 817, 804, 824, 826, 821, 662, 834, 789, 761, 760, 797, 904, 883, 846, 758, 626, 363, 508, 707, 777, 658, 718, 773, 897, 887, 885, 895, 896, 891, 747, 834, 710, 699, 704, 751, 908, 885, 924, 769, 617, 347, 492, 745, 755, 639, 696, 736, 878, 887, 898, 884, 904, 965, 856, 856, 797, 771, 757, 753, 909, 894, 925, 856, 736, 459, 469, 706, 658, 677, 767, 759, 804, 811, 885, 803, 810, 878, 917, 905, 778, 762, 739, 808, 891, 895, 928, 790, 667, 386, 415, 600, 608, 663, 766, 687, 709, 688, 759, 646, 671, 731, 785, 772, 743, 766, 750, 783, 816, 810, 847, 790, 753, 452, 248, 328, 350, 399, 507, 447, 466, 443, 514, 413, 419, 413, 515, 509, 463, 436, 435, 466, 486, 474, 512, 448, 445, 260]

